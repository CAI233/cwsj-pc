<nz-layout class="main-page-layout">
    <nz-header class="main-page-header">
        <nz-breadcrumb>
            <nz-breadcrumb-item>
                <a href="#/home">首页</a>
            </nz-breadcrumb-item>
            <nz-breadcrumb-item>
                商品列表
            </nz-breadcrumb-item>
        </nz-breadcrumb>
    </nz-header>
    <nz-content class="main-page-content">
            <nz-tabset [(nzSelectedIndex)]="selectedIndex" (nzSelectedIndexChange)="change($event)">
                <nz-tab >
                    <ng-template #nzTabHeading>列表</ng-template>
                    <nz-content class="main-page-content">
                        <div class="gutter-example">
                            <div nz-row [nzGutter]="8">
                                <div nz-col class="gutter-row" [ngClass]="{'active': param.goods_type== 1}" (click)="param.goods_type=1;reload(true)">
                                <!-- <i class="anticon anticon-book"></i> -->
                                <span>图书</span>
                                <span class="check">
                                    <i class="anticon anticon-check"></i>
                                </span>
                                </div>
                                <div nz-col class="gutter-row" [ngClass]="{'active': param.goods_type == 2}" (click)="param.goods_type=2;reload(true)">
                                <!-- <i class="anticon anticon-database"></i> -->
                                <span>音视频</span>
                                <span class="check">
                                    <i class="anticon anticon-check"></i>
                                </span>
                                </div>
                                <div nz-col class="gutter-row" [ngClass]="{'active': param.goods_type == 3}" (click)="param.goods_type=3;reload(true)">
                                <!-- <i class="anticon anticon-file-text"></i> -->
                                <span>电子书</span>
                                <span class="check">
                                    <i class="anticon anticon-check"></i>
                                </span>
                                </div>
                            </div>
                        </div>
                    <form nz-form>
                        <div nz-row nz-form-item style="margin-bottom:10px;">
                            <div nz-col [nzSpan]="6">
                                <div nz-form-label nz-col style="float:left;">
                                    <label>商品名称</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="14">
                                    <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="param.searchText" [nzPlaceHolder]="'请输入商品名称'" [nzSize]="'default'"></nz-input>
                                </div>
                            </div>
                            <div nz-col [nzSpan]="6">
                                <div nz-form-label nz-col style="float:left;">
                                    <label>商品分类</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="14">
                                  <nz-cascader style="width:100%" name="project_cat_id" nzChangeOnSelect [nzPlaceHolder]="'请选择'" [nzValueProperty]="'cat_id'" [nzLabelProperty]="'cat_name'" [nzOptions]="classData"
                                      [(ngModel)]="param.cat_ids" >
                                  </nz-cascader>
                                </div>
                            </div>
                            <div nz-col [nzSpan]="6" style="padding:2px 0;">
                                <div class="row-questions" style="float:left;min-width:250px;">
                                    <button nz-button nzType="primary" (click)="reload(true)">
                                        <i class="anticon anticon-search"></i>
                                        <span>查询</span>
                                    </button>
                                    <button nz-button nzType="" (click)="resetForm()">
                                        <span>重置</span>
                                    </button>
                                    <a style="margin-left:15px;font-size:12px;float:right;margin-top:5px;" (click)="isCollapse=!isCollapse">
                                            更多
                                            <i class="anticon" [class.anticon-down]="isCollapse" [class.anticon-up]="!isCollapse"></i>
                                            </a>
                                </div>
                                
                            </div>
                        </div> 
                            <div nz-row nz-form-item *ngIf="!isCollapse" style="margin-bottom:10px;">
                                <div nz-col [nzSpan]="6">
                                    <div nz-form-label nz-col style="float:left;">
                                        <label>创建时间</label>
                                    </div>
                                    <div nz-form-control nz-col [nzSpan]="14">
                                        <nz-rangepicker name="searchTime" [(ngModel)]="paramCol.searchTime" [nzPlaceholder]="['起始日期', '截止日期']" [nzAllowClear]="false"></nz-rangepicker>
                                    </div>
                                </div>
                            </div>
                            <div nz-row nz-form-item>
                              <div class="row-actions">
                                    <button nz-button nzType="primary" type="button" (click)="add()" *ngIf="this.service.validataAction('cw_goods_list_add')">
                                        <i class="anticon anticon-plus" style="font-size:12px;color:#fff;"></i>
                                        <span>新增</span>
                                    </button>
                                    
                              </div>
                            </div>
                        </form>
                        <nz-table #nzTable  nzShowSizeChanger [nzShowTotal]="true" [nzAjaxData]="data" [nzLoading]="_loading" [nzPageSize]="param.pageSize"
                        [nzPageIndex]="param.pageNum" [nzTotal]="param.total" (nzPageIndexChangeClick)="param.pageNum=$event;load($event)"
                        (nzPageSizeChange)="param.pageNum=1;param.pageSize=$event;load($event)">
                          <thead nz-thead>
                          <tr>
                            <th nz-th nzCheckbox>
                              <label nz-checkbox [(ngModel)]="_allChecked" [nzIndeterminate]="_indeterminate" (ngModelChange)="_checkAll($event)">
                              </label>
                            </th>
                            <th nz-th >
                                <span>商品信息</span>
                            </th>
                            <th nz-th >
                                <span>商品分类</span>
                            </th>
                            <th nz-th >
                                <span>商品标签</span>
                            </th>
                            <th nz-th >
                                <span>售价（元）</span>
                            </th>
                            <th nz-th >
                                <span>上架状态</span>
                            </th>
                            <th nz-th >
                                <span>品牌标签</span>
                            </th>
                            <th nz-th >
                                <span>操作</span>
                            </th>
                          </tr>
                          </thead>
                          <tbody nz-tbody>
                            <tr nz-tbody-tr *ngFor="let data of nzTable.data">
                              <td nz-td nzCheckbox>
                                <label nz-checkbox [(ngModel)]="data.checked" (ngModelChange)="_refreshStatus($event)">
                                </label>
                              </td>
                              <td nz-td nz-row>
                                  <!-- <span>{{data.project_name}}</span> -->
                                  <div nz-col [nzSpan]="6" style="float:left;border:1px #ddd dashed;width:72px;height:96px;background: #f5f8fa;">
                                      <img src="{{service.ctxPath + data.goods_cover_small}}" alt="" style="float:left;width:100%;height:100%;">
                                  </div>
                                  <div nz-col [nzSpan]="14" style="padding:10px;">
                                      <p>商品名称:<span [innerHtml]="data.goods_name"></span></p>
                                      <p>商品类型:<span [innerHtml]="['图书','音视频','电子书'][data.goods_type-1]"></span></p>
                                  </div>
                              </td>
                              <td nz-td>
                                  <span>{{data.cat_name}}</span>
                              </td>
                              <td nz-td>
                                  <span>{{data.tag_names}}</span>
                              </td>
                              <td nz-td>
                                  <span>{{data.price}}</span>
                              </td>
                              <td nz-td>
                                  <nz-switch [nzSize]="'small'" [ngModel]="data.enabled == 1" (click)="_enabled(data)" [nzDisabled]="!this.service.validataAction('cw_goods_list_put')"></nz-switch>
                              </td>
                              <td nz-td>
                                  <span>{{get_tagName(data.goods_brand_id)}}</span>
                              </td>
                              <td nz-td>
                                <span *ngIf="this.service.validataAction('cw_goods_list_edit')">
                                  <a (click)="edit(data)">修改</a>
                                  <span nz-table-divider></span>
                                </span>
                                <span >
                                  <a (click)="show(data)">查看</a>
                                  <span nz-table-divider></span>
                                </span>
                                <span *ngIf="this.service.validataAction('cw_goods_list_del')">
                                    <nz-popconfirm [nzTitle]="'确定取消吗?'" (nzOnConfirm)="del(data)">
                                      <a nz-popconfirm>删除</a>
                                    </nz-popconfirm>
                                </span>
                              </td>
                            </tr>
                          </tbody>
                      </nz-table>
                    </nz-content>
                </nz-tab>
                <nz-tab *ngIf="isVisibleMiddle">
                    <ng-template #nzTabHeading>{{formTitle}}<i class="anticon anticon-cross" (click)="closeTab()" style="margin-left:5px;"></i></ng-template>
                    <nz-content class="main-page-content" style="width:600px;">
                        <form nz-form [formGroup]="myForm" class="ditForm">
                            <div nz-form-item nz-row style="margin-bottom:0;">
                                <div nz-col [nzSpan]="12">
                                    <div nz-form-label style="float:left;">
                                        <label>添加商品</label>
                                    </div>
                                    <div nz-form-control style="float:left;padding-top:10px;padding-left:15px;">
                                        <div style="width:72px;height:96px;border:1px solid #ccc;display:inline-block;position:relative;" (click)="_onCheck()">
                                            <div style="position:relative;" *ngIf="nowRecourseArr.length == 0">
                                                <span style="display:inline-block;width:60px;height:4px;background:#ccc;position:absolute;top:45px;left:6px;"></span>
                                                <span style="display:inline-block;width:4px;height:80px;background:#ccc;position:absolute;top:8px;left:33px;"></span>
                                            </div>
                                            <div *ngIf="nowRecourseArr.length>0" style="width:100%;height:100%;">
                                                <img *ngIf="selRow.goods_type==2" src="{{service.ctxPath + nowRecourse.video_cover}}" alt="" style="width:100%;height:100%;"/>
                                                <img *ngIf="selRow.goods_type!=2" src="{{service.ctxPath + nowRecourse.book_cover}}" alt="" style="width:100%;height:100%;"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div nz-col [nzSpan]="12" *ngIf="nowRecourseArr.length>0">
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label style="float:left;">
                                            <label>资源名称</label>
                                        </div>
                                        <div nz-form-control style="float:left;">
                                            <span *ngIf="selRow.goods_type!=2">{{nowRecourse.book_name}}</span>
                                            <span *ngIf="selRow.goods_type==2">{{nowRecourse.video_name}}</span>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label style="float:left;">
                                            <label>资源分类</label>
                                        </div>
                                        <div nz-form-control style="margin-bottom:0;">
                                            <span *ngIf="selRow.goods_type!=2">{{nowRecourse.book_cat_name}}</span>
                                            <span *ngIf="selRow.goods_type==2">{{nowRecourse.video_cat_names}}</span>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label style="float:left;">
                                            <label>资源标签</label>
                                        </div>
                                        <div nz-form-control style="float:left;">
                                            <span *ngIf="selRow.goods_type!=2">{{nowRecourse.book_cat_name}}</span>
                                            <span *ngIf="selRow.goods_type==2">{{nowRecourse.tag_names}}</span>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;" *ngIf="selRow.goods_type!=2">
                                        <div nz-form-label style="float:left;">
                                            <label>作/译者</label>
                                        </div>
                                        <div nz-form-control style="float:left;">
                                            <span >{{nowRecourse.author_name}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:0;">
                                <div nz-col [nzSpan]="12" style="padding-right:10px;">
                                    <div nz-form-label>
                                        <label nz-form-item-required>商品名称</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-input formControlName="goods_name"  [nzType]="'text'" [(ngModel)]="selRow.goods_name" [nzPlaceHolder]="'请填写商品名称'"></nz-input>
                                    </div>
                                </div>
                                <div nz-col [nzSpan]="12" style="padding-left:10px;">
                                    <div nz-form-label>
                                        <label nz-form-item-required>商品分类</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-cascader style="width:100%" formControlName="goods_cat_id" nzChangeOnSelect [nzPlaceHolder]="'请选择'" [nzValueProperty]="'cat_id'" [nzLabelProperty]="'cat_name'" [nzOptions]="classData"
                                            [(ngModel)]="cat_data" (nzSelectionChange)="now_change($event)">
                                        </nz-cascader>
                                    </div>
                                </div>
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:0;">
                                <div nz-col [nzSpan]="12" style="padding-right:10px;">
                                    <div nz-form-label>
                                        <label nz-form-item-required>品牌标签</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-select style="width:100%;" formControlName="goods_brand_id" [nzPlaceHolder]="'请选择'" [(ngModel)]="selRow.goods_brand_id" [nzNotFoundContent]="'无法找到'" nzShowSearch>
                                            <nz-option *ngFor="let item of brandData" [nzLabel]="item.brand_name" [nzValue]="item.brand_id"></nz-option>
                                        </nz-select>   
                                    </div>
                                </div>
                                <div nz-col [nzSpan]="12" style="padding-left:10px;">
                                    <div nz-form-label>
                                        <label nz-form-item-required>商品标签</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-select style="width:100%;" formControlName="goods_tag_ids" nzTags [nzPlaceHolder]="'请选择'" [(ngModel)]="selRow.goods_tag_ids" [nzNotFoundContent]="'无法找到'" nzShowSearch>
                                            <nz-option *ngFor="let item of tagData" [nzLabel]="item.tag_name" [nzValue]="item.tag_id"></nz-option>
                                        </nz-select>   
                                    </div>
                                </div>
                            </div>
                                
                            <div nz-form-item nz-row style="margin-bottom:0;">
                                <div nz-col [nzSpan]="12" style="padding-right:10px;">
                                    <div nz-form-label >
                                        <label>关键字</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-input formControlName="key_word"  [nzType]="'text'" [(ngModel)]="selRow.key_word" [nzPlaceHolder]="'请填写关键字'"></nz-input>
                                    </div>
                                </div>
                                <div nz-col [nzSpan]="12" style="padding-left:10px;">
                                    <div nz-form-label>
                                        <label>售卖截止时间</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-datepicker style="width:100%;" [(ngModel)]="selRow.deadline" formControlName="deadline" nzShowTime [nzPlaceHolder]="'售卖截止时间'" [nzFormat]="'YYYY-MM-DD HH:mm:ss'"></nz-datepicker>
                                    </div>
                                </div>
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:0;" *ngIf="selRow.goods_type==1">
                                <div nz-col [nzSpan]="12" style="padding-right:10px;">
                                    <div nz-form-label >
                                        <label>库存</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-input formControlName="inventory"  [nzType]="'number'" [(ngModel)]="selRow.inventory" [nzPlaceHolder]="'请填写库存'"></nz-input>
                                    </div>
                                </div>
                                <div nz-col [nzSpan]="12" style="padding-left:10px;">
                                    <div nz-form-label>
                                        <label>限购量</label>
                                    </div>
                                    <div nz-form-control>
                                        <nz-input formControlName="limit_buy"  [nzType]="'number'" [(ngModel)]="selRow.limit_buy" [nzPlaceHolder]="'请填写限购数量'"></nz-input>
                                    </div>
                                </div>
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:10px;margin-top:10px;">
                                <div nz-col [nzSpan]="8" style="padding-right:10px;">
                                    <nz-input formControlName="price"  [nzType]="'number'" (ngModelChange)="sum()" [(ngModel)]="selRow.price" [nzPlaceHolder]="'售价'">
                                        <ng-template #addOnBefore ><label nz-form-item-required>售价</label></ng-template>
                                    </nz-input>
                                </div>
                                <div nz-col [nzSpan]="8" style="padding-left:10px;">
                                    <nz-input formControlName="discount"  [nzType]="'number'" (ngModelChange)="sum()"  [(ngModel)]="selRow.discount" [nzPlaceHolder]="'折扣'">
                                        <ng-template #addOnBefore>折扣</ng-template>
                                    </nz-input>
                                </div>
                                <div nz-col [nzSpan]="8" style="padding-left:10px;">
                                    <nz-input formControlName="real_price"  [nzType]="'number'" [(ngModel)]="selRow.real_price"  nzReadonly>
                                        <ng-template #addOnBefore>折后售价<i>¥</i></ng-template>
                                    </nz-input>
                                </div>
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:10px;">
                                <div nz-form-label>
                                    <label>简介</label>
                                </div>
                                <div nz-form-control>
                                    <nz-input formControlName="remark" [(ngModel)]="selRow.remark" [nzRows]="3" [nzType]="'textarea'" [nzPlaceHolder]="'请填写简介'" [nzSize]="'large'">
                                    </nz-input>
                                </div>
                            </div>
                            <div nz-form-item nz-row>
                                
                                <div *ngIf="ebookRecourse.length>0">
                                    <p style="padding-bottom:10px;border-bottom:1px solid #ccc;margin-bottom:10px;">附件资源</p>
                                    <nz-table #nzTable [nzAjaxData]="ebookRecourse" [nzPageSize]="ebookRecourse.length" [nzIsPagination]="false" *ngIf="ebookRecourse.length>0">
                                        <thead nz-thead>
                                            <tr>
                                            <th nz-th><span>名称</span></th>
                                            <th nz-th *ngIf="selRow.goods_type!=2"><span>大小</span></th>
                                            <th nz-th *ngIf="selRow.goods_type!=2"><span>类型</span></th>
                                            <th nz-th><span>操作</span></th>
                                            </tr>
                                        </thead>
                                        <tbody nz-tbody>
                                            <tr nz-tbody-tr *ngFor="let data of nzTable.data">
                                            <td nz-td>
                                                <span>{{data.res_name}}</span>
                                            </td>
                                            <td nz-td *ngIf="selRow.goods_type!=2">
                                                <span>{{data.res_size}}页</span>
                                            </td>
                                            <td nz-td *ngIf="selRow.goods_type!=2">
                                                <span>{{data.res_type}}</span>
                                            </td>
                                            <td nz-td>
                                                <span ><a (click)="bookSee(data)">预览</a></span>
                                            </td>
                                            </tr>
                                        </tbody>
                                    </nz-table>
                                </div>
                            </div>

                            <button  nz-button [nzType]="'primary'" (click)="_submitForm($event)"><span>保存</span></button>
                        </form>
                    </nz-content>
                </nz-tab>
                <nz-tab *ngIf="isShow">
                    <ng-template #nzTabHeading>商品详情<i class="anticon anticon-cross" (click)="closeTab()" style="margin-left:5px;"></i></ng-template>
                    <nz-content class="main-page-content" style="width:600px;">
                        <form nz-form>
                            <!--行-->
                            <div nz-row nz-form-item>
                                <div nz-col [nzSpan]="24" >
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                      <div nz-col [nzSpan]="24">
                                        <div nz-form-label nz-col style="float:left;">
                                          <label>商品名称</label>
                                        </div>
                                        <div nz-form-control nz-col [nzSpan]="18">
                                          <p>{{showData.goods_name}}</p>
                                        </div>
                                      </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                      <div nz-col [nzSpan]="12">
                                        <div nz-form-label nz-col style="float:left;">
                                          <label>商品类型</label>
                                        </div>
                                        <div nz-form-control nz-col style="float:left;">
                                          <p>{{['图书','音视频','电子书'][showData.goods_type-1]}}</p>
                                        </div>
                                      </div>
                                      <div nz-col [nzSpan]="12">
                                        <div nz-form-label nz-col style="float:left;">
                                          <label>品牌标签</label>
                                        </div>
                                        <div nz-form-control nz-col style="float:left;">
                                          <p>{{showData.goods_brand_name}}</p>
                                        </div>
                                      </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                              <label>商品分类</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                              <p>{{showData.cat_name}}</p>
                                            </div>
                                        </div>
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                              <label>商品标签</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                              <p>{{showData.tag_names}}</p>
                                            </div>
                                        </div> 
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                              <label>关键字</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                              <p>{{showData.key_word}}</p>
                                            </div>
                                        </div>
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                              <label>商品售价</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                              <p>{{showData.real_price}}</p>
                                            </div>
                                        </div> 
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;" *ngIf="showData.goods_type==1">
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                                <label>库存</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                                <p>{{showData.inventory}}</p>
                                            </div>
                                        </div>
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                                <label>限购量</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                                <p>{{showData.limit_buy}}</p>
                                            </div>
                                        </div> 
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-col [nzSpan]="12">
                                            <div nz-form-label nz-col style="float:left;">
                                              <label>售卖截止时间</label>
                                            </div>
                                            <div nz-form-control nz-col style="float:left;">
                                              <p>{{showData.deadline}}</p>
                                            </div>
                                        </div>
                                        
                                    </div>
                                  </div>
                            </div>
                            <div nz-row nz-form-item style="margin-bottom:0;" *ngIf="nowRecourseArr.length>0">
                              <p style="padding-bottom:10px;border-bottom:1px solid #ccc;margin-bottom:10px;">商品资源</p>
                            
                              <div nz-row nz-form-item style="margin-bottom:0;">
                                <div nz-col style="float:left;padding-top:10px;">
                                    <img *ngIf="showData.goods_type!=2" src="{{ service.ctxPath + nowRecourse.book_cover }}" style="float:left;width:72px;height:96px;"/>
                                    <img *ngIf="showData.goods_type==2" src="{{ service.ctxPath + nowRecourse.video_cover }}" style="float:left;width:72px;height:96px;"/> 
                                </div >
                                <div nz-col style="float:left;padding-left:15px;">
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label  style="float:left;">
                                          <label>名称</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                          <p *ngIf="showData.goods_type!=2">{{nowRecourse.book_name}}</p>
                                          <p *ngIf="showData.goods_type==2">{{nowRecourse.video_name}}</p>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label  style="float:left;">
                                          <label>类型</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                          <p>{{['图书','音视频','电子书'][showData.goods_type-1]}}</p>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label  style="float:left;">
                                          <label>分类</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                          <p *ngIf="showData.goods_type!=2">{{nowRecourse.book_cat_name}}</p>
                                          <p *ngIf="showData.goods_type==2">{{nowRecourse.video_cat_names}}</p>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label  style="float:left;">
                                          <label>标签</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                          <p>{{nowRecourse.tag_names}}</p>
                                        </div>
                                    </div>
                                </div>
                              </div>
                                <div nz-row nz-form-item style="margin-bottom:0;width:100%;">
                                    <div nz-form-item nz-row style="margin-bottom:0;" *ngIf="showData.goods_type!=2">
                                        <div nz-form-label  style="float:left;">
                                            <label>作/译者</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                            <p>{{nowRecourse.author_name}}</p>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;" *ngIf="showData.goods_type!=2">
                                        <div nz-form-label  style="float:left;">
                                            <label>出版社</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                            <p>{{nowRecourse.publisher}}</p>
                                        </div>
                                    </div>
                                    <div nz-form-item nz-row style="margin-bottom:0;">
                                        <div nz-form-label  style="float:left;">
                                            <label>简介</label>
                                        </div>
                                        <div nz-form-control  style="float:left;">
                                            <p *ngIf="showData.goods_type!=2">{{nowRecourse.book_remark}}</p>
                                            <p *ngIf="showData.goods_type==2">{{nowRecourse.video_remark}}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div nz-row nz-form-item *ngIf="ebookRecourse.length>0">
                                <p style="padding-bottom:10px;border-bottom:1px solid #ccc;margin-bottom:10px;">附件资源</p>
                                <div nz-row nz-form-item style="margin-bottom:0;" *ngFor="let item of ebookRecourse;">
                                  <div nz-col [nzSpan]="12">
                                    <div nz-form-label nz-col style="float:left;">
                                      <label>资源名称</label>
                                    </div>
                                    <div nz-form-control nz-col style="float:left;">
                                      <p >{{item.res_name}}</p>
                                    </div>
                                  </div>
                                  <div nz-col [nzSpan]="6">
                                    <div nz-form-label nz-col style="float:left;">
                                        <label>资源类型</label>
                                    </div>
                                    <div nz-form-control nz-col style="float:left;">
                                        <p>{{item.res_type}}</p>
                                    </div>
                                   </div>
                                  <div nz-col [nzSpan]="6" style="line-height:32px;">
                                    <a href="javascript:void(0)" (click)="bookSee(item)">预览</a>
                                  </div>
                                </div>
                            </div>
                        </form>
                    </nz-content>
                </nz-tab>
            </nz-tabset>
    </nz-content>
  </nz-layout> 
<nz-modal [nzVisible]="isVisibleVideo" [nzTitle]="modalTitle1" [nzContent]="modalContent1" [nzFooter]="modalFooter1" (nzOnCancel)="_vedioCancel($event)">
    <ng-template #modalTitle1>
      视频预览
    </ng-template>
    <ng-template #modalContent1>
      <video *ngIf="videoModel" src="{{service.ctxPath+videoModel.res_url}}" style="width:100%" controls="controls" autoplay></video>
    </ng-template>
    <ng-template #modalFooter1 style="display:none"></ng-template>
  </nz-modal>
  <nz-modal [nzVisible]="isVisiblePdf" [nzWidth]="700" [nzTitle]="modalTitle2" [nzContent]="modalContent2" [nzFooter]="modalFooter2" (nzOnCancel)="_bookCancel($event)">
    <ng-template #modalTitle2>
        <span *ngIf="pdfModel">第 {{ pdfMinNum +'/' +pdfModel.res_size}}页</span>
    </ng-template>
    <ng-template #modalContent2>
        <div class="pwImgList" *ngIf="pdfModel">
            <i class="anticon anticon-left" (click)="pdfMinNum1()"></i>
            <div class="imgList">
            <img src="{{service.ctxPath+pdfModel.res_analysis_url+'/img'+pdfMinNum+'.png'}}">
            </div>
            <i class="anticon anticon-right" (click)="pdfMinNum2()"></i>
        </div>
    </ng-template>
    <ng-template #modalFooter2 style="display:none"></ng-template>
</nz-modal>
<nz-modal [nzVisible]="isCheck" [nzWidth]="800" [nzTitle]="'资源列表'" [nzContent]="CheckContent" [nzFooter]="false" (nzOnCancel)="_CheckCancel($event)">
        <ng-template #CheckContent>
            <form nz-form>
                <div nz-row nz-form-item style="margin-bottom:10px;">
                    <div nz-col [nzSpan]="8">
                        <div nz-form-label nz-col style="float:left;">
                            <label>资源名称</label>
                        </div>
                        <div nz-form-control nz-col [nzSpan]="14">
                            <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="check_param.searchText" [nzPlaceHolder]="'请输入商品名称'" [nzSize]="'default'"></nz-input>
                        </div>
                    </div>
                    <div nz-col [nzSpan]="8">
                        <div nz-form-label nz-col style="float:left;">
                            <label>资源分类</label>
                        </div>
                        <div nz-form-control nz-col [nzSpan]="14">
                            <nz-cascader #Check_catIds style="width:100%" name="cat_id" nzChangeOnSelect [nzPlaceHolder]="'请选择'" [nzValueProperty]="'cat_id'" [nzLabelProperty]="'cat_name'" [nzOptions]="allClass"
                                [(ngModel)]="Check_cat_ids" (nzSelectionChange)="check_change($event)">
                            </nz-cascader>
                        </div>
                    </div>
                    <div nz-col [nzSpan]="8" style="padding:2px 0;">
                        <div class="row-questions" style="float:left;">
                            <button nz-button nzType="primary" (click)="reloadRecourse(true)">
                                <i class="anticon anticon-search"></i>
                                <span>查询</span>
                            </button>
                            <button nz-button nzType="" (click)="resetRecourse()">
                                <span>重置</span>
                            </button>
                        </div>
                        <a style="margin-left:15px;font-size:12px;float:left;margin-top:5px;" (click)="isRecourse=!isRecourse">
                        更多
                        <i class="anticon" [class.anticon-down]="isRecourse" [class.anticon-up]="!isRecourse"></i>
                        </a>
                    </div>
                </div> 
                <div nz-row nz-form-item *ngIf="!isRecourse" style="margin-bottom:10px;">
                    <div nz-col [nzSpan]="8">
                        <div nz-form-label nz-col style="float:left;">
                            <label>资源标签</label>
                        </div>
                        <div nz-form-control nz-col [nzSpan]="14">
                            <nz-select style="width:100%;" name="tag_id"  nzAllowClear [nzPlaceHolder]="'请选择'" [(ngModel)]="check_param.tag_id" nzShowSearch>
                                <nz-option *ngFor="let item of allTags" [nzLabel]="item.tag_name" [nzValue]="item.tag_id"></nz-option>
                            </nz-select>
                        </div>
                    </div>
                </div>
                </form>

            <nz-table #nzTableRecourse [nzDataSource]="allRecourse"  [nzPageSize]="5">
                <thead nz-thead>
                    <tr>
                        <th nz-th><span>资源封面</span></th>
                        <th nz-th><span>资源名称</span></th>
                        <th nz-th><span>资源分类</span></th>
                        <th nz-th>资源标签</th>
                        <th nz-th *ngIf="selRow.goods_type!=2">作/译者:</th>
                        <th nz-th >备注:</th>
                        <th nz-th>操作</th>
                    </tr>
                </thead>
                <tbody nz-tbody>
                    <tr nz-tbody-tr *ngFor="let data of nzTableRecourse.data">
                    <td nz-td>
                        <img *ngIf="selRow.goods_type!=2" src="{{ service.ctxPath + data.book_cover }}" style="float:left;width:72px;height:96px;"/>
                        <img *ngIf="selRow.goods_type==2" src="{{ service.ctxPath + data.video_cover }}" style="float:left;width:72px;height:96px;"/> 
                    </td>
                    <td nz-td>
                        <span *ngIf="selRow.goods_type!=2">{{data.book_name}}</span>
                        <span *ngIf="selRow.goods_type==2">{{data.video_name}}</span>
                    </td>
                    <td nz-td>
                        <span *ngIf="selRow.goods_type!=2">{{data.book_cat_name}}</span>
                        <span *ngIf="selRow.goods_type==2">{{data.video_cat_names}}</span>
                    </td>
                    <td nz-td>
                        <span *ngIf="selRow.goods_type!=2">{{data.tag_names}}</span>
                        <span *ngIf="selRow.goods_type==2">{{data.tag_names}}</span>
                    </td>
                    <td nz-td *ngIf="selRow.goods_type!=2">
                        <span >{{data.author_name}}</span>
                    </td>
                    <td nz-td >
                        <span *ngIf="selRow.goods_type!=2">{{data.book_remark}}</span>
                        <span *ngIf="selRow.goods_type==2">{{data.video_remark}}</span>
                    </td>
                    <td nz-td>
                        <span >
                            <a *ngIf="selRow.goods_type!=2" (click)="isCheck=false;selected(data.book_id)">加入</a>
                            <a *ngIf="selRow.goods_type==2" (click)="isCheck=false;selected(data.video_id)">加入</a>
                            <!-- <span nz-table-divider></span> -->
                        </span>
                    </td>
                    </tr>
                </tbody>
            </nz-table>
        </ng-template>
</nz-modal>
