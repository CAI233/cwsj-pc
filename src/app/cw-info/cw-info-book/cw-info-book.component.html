<nz-layout class="main-page-layout">
    <nz-header class="main-page-header">
      <nz-breadcrumb>
        <nz-breadcrumb-item>
          <a href="#/home">首页</a>
        </nz-breadcrumb-item>
        <nz-breadcrumb-item>
          图书管理
        </nz-breadcrumb-item>
      </nz-breadcrumb>
    </nz-header>
    <nz-content class="main-page-content">
        <nz-tabset (nzSelectedIndexChange)="change($event)" (nzSelectedIndex)="selectedIndex">
            <nz-tab *ngFor="let tab of tabs">
                <ng-template #nzTabHeading>
                {{tab.content}}
                </ng-template>
            </nz-tab>
        </nz-tabset>
        <form nz-form>
            <div nz-row nz-form-item>
                <div nz-col [nzSpan]="6">
                    <div nz-form-label nz-col style="float:left;">
                        <label>图书名称</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="12">
                        <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="param.searchText" [nzPlaceHolder]="'请输入查询条件'" [nzSize]="'default'"></nz-input>
                    </div>
                </div>
                <div nz-col [nzSpan]="6">
                    <div nz-form-label nz-col style="float:left;">
                        <label>标签</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="14">
                        <nz-select style="width: 200px;" name="order_status" nzAllowClear [nzPlaceHolder]="'请选择'" [(ngModel)]="param.search_id" nzShowSearch>
                        <nz-option *ngFor="let item of orderList" [nzLabel]="item.name" [nzValue]="item.id"></nz-option>
                    </nz-select>
                    </div>
                </div>
                <div nz-col [nzSpan]="6">
                    <div nz-form-label nz-col style="float:left;">
                        <label>分类</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="14">
                        <nz-select style="width: 200px;" name="order_status" nzAllowClear [nzPlaceHolder]="'请选择'" [(ngModel)]="param.search_id" nzShowSearch>
                        <nz-option *ngFor="let item of orderList" [nzLabel]="item.name" [nzValue]="item.id"></nz-option>
                    </nz-select>
                    </div>
                </div>
                <div nz-col [nzSpan]="6">
                    <div nz-form-label nz-col style="float:left;">
                        <label>发布状态</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="14">
                        <nz-select style="width: 200px;" name="order_status" nzAllowClear [nzPlaceHolder]="'请选择'" [(ngModel)]="param.search_id" nzShowSearch>
                        <nz-option *ngFor="let item of orderList" [nzLabel]="item.name" [nzValue]="item.id"></nz-option>
                    </nz-select>
                    </div>
                </div>
            </div> 
            <div nz-row nz-form-item style="margin-bottom:0;">
                <div nz-row nz-form-item>
                    <div class="row-actions">
                        <button nz-button nzType="primary" type="button" (click)="_add()">
                        <i class="anticon anticon-plus" style="font-size:12px;color:#fff;"></i>
                        <span>新增</span>
                        </button>
                    </div>
                    <div class="row-questions">
                        <!-- <button nz-button nzType="primary" (click)="reload(true)">
                            <i class="anticon anticon-search"></i>
                            <span>查询</span>
                        </button>
                        <button nz-button nzType="" (click)="resetForm()">
                            <span>重置</span>
                        </button> -->
                    </div>
                </div>
            </div>
        </form>
        <nz-table #nzTable  nzShowSizeChanger [nzShowTotal]="true" [nzAjaxData]="data" [nzLoading]="_loading" [nzPageSize]="param.pageSize"
      [nzPageIndex]="param.pageNum" [nzTotal]="param.total" (nzPageIndexChangeClick)="param.pageNum=$event;load($event)"
      (nzPageSizeChange)="param.pageNum=1;param.pageSize=$event;load($event)">
        <thead nz-thead>
        <tr>
          <th nz-th nzCheckbox>
            <label nz-checkbox [(ngModel)]="_allChecked" [nzIndeterminate]="_indeterminate" (ngModelChange)="_checkAll($event)">
            </label>
          </th>
          <th nz-th [nzWidth]="'20%'">
              <span>图书信息</span>
          </th>
          <th nz-th [nzWidth]="'10%'">
              <span>图书分类</span>
          </th>
          <th nz-th [nzWidth]="'10%'">
              <span>标签/关键字</span>
          </th>
          <th nz-th [nzWidth]="'10%'">
              <span>发布状态</span>
          </th>
          <th nz-th [nzWidth]="'10%'">
              <span>审核状态</span>
          </th>
          <th nz-th [nzWidth]="'10%'">
              <span>创建时间</span>
          </th>
          <th nz-th >
              <span>操作</span>
          </th>
        </tr>
        </thead>
        <tbody nz-tbody>
          <tr nz-tbody-tr *ngFor="let data of nzTable.data">
            <td nz-td nzCheckbox>
              <label nz-checkbox [(ngModel)]="data.checked" (ngModelChange)="_refreshStatus($event)">
              </label>
            </td>
            <td nz-td nz-row>
                <div nz-col [nzSpan]="6" style="float:left;border:1px #ddd dashed;height:80px;background: #f5f8fa;">
                    <img src="{{service.ctxPath + data.book_cover_small}}" alt="" style="float:left;width:100%;height:100%;">
                </div>
                <div nz-col [nzSpan]="18" style="padding:5px;">
                    <p>图书名称:<span [innerHtml]="data.book_name"></span></p>
                    <p>作/译者:<span [innerHtml]="data.author_name"></span></p>
                    <p>出版社:<span [innerHtml]="data.publisher"></span></p>
                    <p>标准书号:<span [innerHtml]="data.book_isbn"></span></p>
                </div>
            </td>
            <td nz-td>
                <span>{{data.book_cat_name}}</span>
            </td>
            <td nz-td>
                <p>{{data.tag_id}}</p>
                <p>{{data.key_word}}</p>
            </td>
            <td nz-td>
                <span>{{data.status}}</span>
            </td>
            <td nz-td>
                <span>{{['草稿','待审核','通过','驳回'][data.audit_status-1]}}</span>
            </td>
            <td nz-td>
                <span>{{data.create_time}}</span>
            </td>
            <td nz-td>
              <span >
                <a (click)="_see(data)">查看详情</a>
                <span nz-table-divider></span>
              </span>
              <span >
                <a (click)="_join(data)">进入管理</a>
                <span nz-table-divider></span>
              </span>
              <span >
                <a (click)="_audit(data)">提交审核</a>
                <span nz-table-divider></span>
              </span>
              <span >
                <a (click)="_edit(data)">修改</a>
                <span nz-table-divider></span>
                </span>
              <span >
                  <nz-popconfirm [nzTitle]="'确定取消吗?'" (nzOnConfirm)="del(data)">
                    <a nz-popconfirm>删除</a>
                  </nz-popconfirm>
              </span>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </nz-content>
  </nz-layout>
  <!-- <nz-modal [nzMaskClosable]="false" [nzWidth]="800" [nzWrapClassName]="'vertical-center-modal'" [nzContent]="bookContent"
  [nzVisible]="bookList" (nzOnCancel)="bookCancel($event)" (nzOnOk)="bookOk($event)" [nzTitle]="'新增纸质图书'">
  <ng-template #bookContent>
      <form nz-form [formGroup]="myForm" (ngSubmit)="_submitbook()" class="ditForm">
            <nz-tabset>
                <nz-tab>
                    <ng-template #nzTabHeading>商品信息</ng-template>
                    <div nz-row nz-form-item>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-item nz-row style="margin-bottom:10px;">
                                <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                    <label nz-form-item-required>图书名称</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="16">
                                    <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                                </div> 
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:10px;">
                                <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                    <label nz-form-item-required>图书分类</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="16">
                                    <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                                </div> 
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:10px;">
                                <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                    <label nz-form-item-required>图书标签</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="16">
                                    <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                                </div> 
                            </div>
                            <div nz-form-item nz-row style="margin-bottom:10px;">
                                <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                    <label nz-form-item-required>关键字</label>
                                </div>
                                <div nz-form-control nz-col [nzSpan]="16">
                                    <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                                </div> 
                            </div>
                        </div>
                        <div nz-col [nzSpan]="12" style="text-align:center;padding:15px 90px">
                            <div style="float:left;border:1px #ddd dashed;height:120px;width:100%;margin-bottom:15px;background: #f5f8fa;">
                                <img *ngIf="bookData.icon" src="{{ service.ctxPath + bookData.icon }}" style="float:left;width:100%;height:100%;"/>
                            </div>
                            <nz-upload [nzShowUploadList]="false" (nzChange)="fileUpload($event)" [nzAccept]="'image/gif,image/jpeg,image/png,image/jpg,image/bmp'"
                                nzAction="{{service.ctxPath + '/api/system/file/upload'}}" [nzData]="{type:'admin',token:service.token}">
                                <button nz-button type="button">
                                    <i class="anticon anticon-upload"></i>
                                    <span>上传头像</span>
                                </button>
                            </nz-upload>
                        </div>
                    </div>
                    <div nz-row nz-form-item>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>标准书号</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                            </div> 
                        </div>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>出版社</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [nzDisabled]="true" [(ngModel)]="bookData.searchText"  [nzSize]="'default'"></nz-input>
                            </div>
                        </div>
                    </div>
                    <div nz-row nz-form-item>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>作/译者</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                            </div> 
                        </div>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>出版时间</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'"  [nzSize]="'default'"></nz-input>
                            </div>
                        </div>
                    </div>
                    <div nz-row nz-form-item>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>库存</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                            </div> 
                        </div>
                        <div nz-col [nzSpan]="12">
                            <div nz-form-label nz-col style="float:left;" [nzSpan]="8">
                                <label nz-form-item-required>限购量</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <nz-input [nzType]="'text'" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'"  [nzSize]="'default'"></nz-input>
                            </div>
                        </div>
                    </div>
                    <div nz-row nz-form-item>
                        <div nz-form-label >
                            <label nz-form-item-required>简介</label>
                        </div>
                        <div nz-form-control >
                            <nz-input [nzType]="'textarea'" [nzRows]="3" name="searchText" [(ngModel)]="bookData.searchText" [nzPlaceHolder]="'请输入'" [nzSize]="'default'"></nz-input>
                        </div> 
                    </div>
                </nz-tab>
                <nz-tab>
                    <ng-template #nzTabHeading>二维码管理</ng-template>
                    
                </nz-tab>
            </nz-tabset>
      </form>
  </ng-template>
</nz-modal>
<nz-modal [nzMaskClosable]="false" [nzWidth]="800" [nzWrapClassName]="'vertical-center-modal'" [nzContent]="seeContent"
[nzVisible]="seeList" (nzOnCancel)="bookCancel($event)" [nzTitle]="'图书详情'" [nzFooter]="false">
<ng-template #seeContent>
    <div nz-row>
        <div nz-col [nzSpan]="12">
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">图书名称</span><span nz-col [nzSpan]="18"></span></p>
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">图书分类</span><span nz-col [nzSpan]="18"></span></p>
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">标签</span><span nz-col [nzSpan]="18"></span></p>
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">关键字</span><span nz-col [nzSpan]="18"></span></p>
        </div>
        <div nz-col [nzSpan]="12" style="text-align:center;padding:15px 90px">
            <div style="float:left;border:1px #ddd dashed;height:120px;width:100%;margin-bottom:15px;background: #f5f8fa;">
                <img *ngIf="bookData.icon" src="{{ service.ctxPath + bookData.icon }}" style="float:left;width:100%;height:100%;"/>
            </div>
        </div>
    </div>
    <div nz-row>
        <div nz-col [nzSpan]="12">
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">标准书号</span><span nz-col [nzSpan]="18"></span></p>
        </div>
        <div nz-col [nzSpan]="12">
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">出版社</span><span nz-col [nzSpan]="18"></span></p>
        </div>
    </div>
    <div nz-row>
        <div nz-col [nzSpan]="12">
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">作/译者</span><span nz-col [nzSpan]="18"></span></p>
        </div>
        <div nz-col [nzSpan]="12">
            <p nz-row class="see_class"><span nz-col [nzSpan]="6">出版时间</span><span nz-col [nzSpan]="18"></span></p>
        </div>
    </div>
    <div nz-row>
        <p nz-row class="see_class"><span nz-col [nzSpan]="6">简介</span><span nz-col [nzSpan]="18"></span></p>
    </div>
    <div>
        <p class="see_class" style="border-bottom:1px solid #e9e9e9">二维码关联</p>
    </div>
</ng-template>
</nz-modal>

 -->

